# 第一次模拟训练A题

<p style="text-align: center; font-weight: bold;">摘要</p>

<p style="text-align: left; text-indent: 2em;">
    本研究针对一个拥有200英亩农场的农场主,在现有条件下制定了一个5年的生产计划。农场主要产出为奶牛和牛奶。研究考虑了奶牛的生命周期、土地利用效率、饲料供给、经济效益和农场的可持续性。模型包括了奶牛的出生率、死亡率、产奶量和土地的粮食及甜菜产量。同时,考虑了农场雇佣的工人成本、饲料成本以及可能的牛舍扩建投资。模型的约束条件包括农场牛舍容量限制、奶牛数量范围以及不允许年度现金流量为负。通过优化模型,得出了一项旨在提高农场盈利能力、合理配置资源和保持奶牛数量可持续的生产计划。
</p>
<p style="text-align: left; text-indent: 2em; font-weight: bold;">	
关键词：可持续性 生产计划 资源优化 经济效益 成本效益分析
</p>


## 问题重述

###  问题背景

​	在一个拥有200英亩土地的农场上,农场主的主要收入来源是奶牛饲养和牛奶生 产。农场目前拥有120头奶牛,其中包括100头成年奶牛和20头小母牛。每头成年奶牛 每年可以产出1.1头小牛,其中一半为公牛,出生后不久便以30美元的价格出售,另 一半为小母牛,可以选择以40美元的价格出售,或饲养到两岁成为成年奶牛。成年奶 牛的产奶期为2岁到11岁,每年可以产生370美元的牛奶收入。12岁及以上的奶牛产奶 量减少,因此通常会被以120美元的价格出售。奶牛和小母牛分别需要1英亩和2/3英 亩的土地来饲养。 农场有80英亩的土地适合种植粮食,产量因土地的不同而有所差异；此外,甜菜 可以在其他土地上种植,产量为1.5吨/英亩。甜菜和粮食可以用于奶牛饲养或出售。 农场的牛舍当前最大可容纳130头牛,但可以通过每200美元的投资增加1头牛的饲养 容量。农场主还可以通过贷款来扩充牛舍,贷款年利率为15 此外,农场每年支出4000美元的工资,获得5500小时的劳动力,可以通过支付1.20美 元/小时的价格获得额外劳动力。农场在劳动力和土地分配、奶牛饲养和农产品种植 之间需要做出合理的规划,以实现五年内的利润最大化。 

### 问题提出 

​	在一个拥有200英亩土地的农场上,农场主以奶牛饲养和牛奶生产为主要经济来源。当前农场拥有120头奶牛,其中包括100头成年奶牛和20头小母牛（小于2岁 的母牛）。为了优化农场的生产和运营,需要制定一个为期5年的详细生产计划,使得农场在满足资源和经济约束的前提下,能够实现利润的最大化。

## 符号变量

| 符号变量                 | 含义                                         |
| :------------------------- | :------------------------------------------- |
| $ a_{i} $               | 第 $i$ 个年龄段的生育率          |
| $ b_{i} $               | 第 $i$ 个年龄段的存活率            |
| $ \mathbf{x^{(k)}} $               | 第 $ t_k $时刻种群数量分布向量            |
| $ \mathbf{x^{(0)}} $      | 初始种群数量分布向量                         |
| $ x_{i}^{(k)} $         | 第 $ t_k $时刻第 $ i $个年龄组的数量 |
| $ \mathbf{L^{''}} $       | 莱斯利雌雄总矩阵                     |
| $ \mathbf{L^{'}} $       | 莱斯利雌性或雄性矩阵                     |
| $ \mathbf{L_{r}} $            | 考虑出售$r$比例小母牛后,莱斯利雌性矩阵 |
| $ \mathbf{y}_{1} $        | 选择矩阵,用于提取第一个元素                 |
| $ \mathbf{y}_{12} $       | 选择矩阵,用于提取最后一个元素               |
| $ \mathbf{y}_{3,12} $       | 选择矩阵,用于提取第三个至最后一个元素               |
| $ r $                     | 小母牛出售的比例                           |
| $ w^{(k)}_{小公牛} $     | 第 $ t_k $时刻出售小公牛所得金额          |
| $ w^{(k)}_{小母牛} $     | 第 $ t_k $时刻出售小母牛所得金额          |
| $ w^{(k)}_{老母牛} $     | 第 $ t_k $时刻出售老母牛所得金额          |
| $ w^{(k)}_{大母牛} $     | 第 $ t_k $时刻大母牛所得金额              |
| $ M $                     | 总贷款金额                                   |
| $ m $                     | 每年还款额度                                 |
| $ \alpha $                | 牧草种植所需土地面积（英亩）,也指牧草        |
| $ \beta $                 | 粮食种植所需土地面积（英亩）,也指粮食        |
| $ \gamma $                | 甜菜种植所需土地面积（英亩）,也指甜菜         |
| $ q_{\beta} $  | 粮食的产量                                   |
| $ q_{\gamma}  $  | 甜菜的产量                                   |
| $ t_{\beta} $             | 种植粮食所需时间                             |
| $ t_{\gamma} $            | 种植甜菜所需时间                             |
| $ t_{小母牛} $        | 饲养小母牛所需时间                           |
| $ t_{大母牛} $        | 饲养大母牛所需时间                           |
| $ t $                     | 总时间                                       |
| $ c_{\beta} $          | 种植粮食的成本                               |
| $ c_{\gamma} $         | 种植甜菜的成本                               |
| $ c_{小母牛} $     | 饲养小母牛的成本                             |
| $ c_{大母牛} $     | 饲养大母牛的成本                             |
| $ c $                  | 总成本                                       |

​		其中独立参数如下

| 符号变量                 | 含义                                         |
| :------------------------- | :------------------------------------------- |
| $ r $                     | 小母牛出售的比例                           |
| $ M $                     | 总贷款金额                                   |
| $ \alpha $                | 牧草种植所需土地面积（英亩）,也指牧草        |
| $ \beta $                 | 粮食种植所需土地面积（英亩）,也指粮食        |
| $ \gamma $                | 甜菜种植所需土地面积（英亩）,也指甜菜         |

## 问题分析

### **问题目标** 

​	制定一个以五年为期的生产计划,以优化农场的产 出,最大化利润。

### **决策变量**

​	小母牛出售比例
​	贷款资金
​	种植牧草的土地
​	种植粮食的土地(分为4块)
​	种植甜菜的土地

### **约束条件**

​	土地利用:土地的分配必须满足奶牛和小母牛的需求.
​	牛舍容量:当前和潜在的牛舍容量限制必须被考虑。
​	资金预算:确保年度现金流量不为负,并考虑到贷款的偿还。
​	劳动力:考虑贷款成本和年度还款,确保财务健康。
​	奶牛数量:五年后奶牛数量必须符合规定,且非负,整数。

### **模型假设** 

​	假设奶牛每年增长和繁殖的速率是固定的,不受其他因素影响。 
​	假设每头奶牛每天对饲料的消耗量是恒定的。
​	假设每种作物在单位土地上的产出是固定的,不受气候变化和土壤退化影响。 
​	假设每个劳动力单元（例如,每个工人每小时）可以完成的工作量是固定的 。
​	假设贷款的利率是固定的,还款计划是预先设定的。 
​	假设小母牛和公牛的出售价格和淘汰奶牛的成本是固定的。 
​	假设在计划期间,没有新的政策和法规会影响农场的运营。 
​	假设疾病爆发、自然灾害等风险的概率是已知的,且可以通过保险或其他手段来管理。

### 奶牛

#### 牛群繁殖逻辑

​	记 $x_{i}$ 为种群中第 $i$ 个年龄组中的奶牛数量(雌性,下同),记 $t_{k}$ 为第 $k$ 年 ,则 $t_{k}$ 时种群中第 $i$ 个年龄组的奶牛数量可表示为 $x_{i}^{(k)}$ ,其中$ i = 1,2,...,12 \:;\: k = 0,1,2,3,4,5.$
​	不出售第一个年龄组小母牛的情况下, $t_{k}$ 时种群中第一个年龄组的种群数量等于 $t_{k-1}$ 时各年龄组产下的雌性幼体总和
$$
x_1^{(k)}=a_1x_1^{(k-1)}+a_2x_2^{(k-1)}+\cdots+a_nx_n^{(k-1)}\:,\quad k =1 ,2 ,\cdots,5
$$

​	$t_{k}$ 时第$i+1$个年龄组中雌性奶牛的数量等于 $t_{k-1}$ 时第 $i$ 个年龄组中存活下来的雌性奶牛的数量

$$
x_{i+1}^{(k)}=b_{i}x_{i}^{(k-1)}\:,\quad i=1\:,2\:,\cdots,12\
$$

​	遍历上述$12$个存活公式,并在最初添加种群数量的繁殖条件公式,有

$$
\begin{cases}
x_{1}^{(k)} = a_{1}x_{1}^{(k-1)} + a_{2}x_{2}^{(k-1)} + \cdots + a_{12}x_{12}^{(k-1)} \:\\
x_{2}^{(k)} = b_{1}x_{1}^{(k-1)} \: \\
x_{3}^{(k)} = b_{2}x_{2}^{(k-1)} \:\\
\vdots \\
x_{13}^{(k)} = b_{12}x_{12}^{(k-1)} \:
\end{cases}
$$

​	当 $t_{k}$ 年出售 $r$ 比例的刚出生的小母牛,即出售小母牛的数量为 $(a_1x_1^{(k-1)} + a_2x_2^{(k-1)} + \cdots + a_nx_n^{(k-1)}) \times r$ ,由此更新第一个年龄段种群雌性数量的迭代公式如下

$$
x_1^{(k)} = (\: a_1x_1^{(k-1)} + a_2x_2^{(k-1)} + \cdots + a_nx_n^{(k-1)} \:) \times (1 - r) \\
$$

​	此时,有

$$
\begin{cases}
x_1^{(k)} = ( \: a_{1}x_{1}^{(k-1)} + a_{2}x_{2}^{(k-1)} + \cdots + a_{12}x_{12}^{(k-1)} \: ) \times (1 - r) \: \\
x_2^{(k)}=b_{1}x_{1}^{(k-1)} \:
\\x_3^{(k)}=b_{2}x_{2}^{(k-1)}\: \\
\vdots \\
x_{13}^{(k)}=b_{12}x_{12}^{(k-1)} \:
\end{cases}
$$

#### 小公牛

​	$t_{k}$ 年出售小公牛所得金额 =  $ t_{k}$ 年出售小公牛的数量  $\times$ 出售一只小公牛的价格

$$
w^{(k)}_{小公牛} =  x_{1}^{(k)} \times 30
$$

​	则出售小公牛五年后毛利为

$$
w_{小公牛} = \sum_{k=1}^{5} w^{(k)}_{小公牛} = \sum_{k=1}^{5} x_{1}^{(k)} \times 30
$$

#### 小母牛

​	类似的，$t_{k}$ 年出售小母牛所得金额 =  $ t_{k}$ 年出售小母牛的数量  $\times$ 出售一只小母牛的价格
$$
w^{(k)}_{小母牛} = x_{1}^{(k)} \times 40
$$

​	则出售小母牛五年后毛利为
$$
w_{小母牛} = \sum_{k=1}^{5} w^{(k)}_{小母牛} = \sum_{k=1}^{5} x_{1}^{(k)} \times 40
$$
​	$t_{k}$ 年工人饲养小母牛所耗费时间 =  $t_{k}$ 年工人饲养小母牛的数量 $\times$ 饲养一只小母牛所耗费的时间
$$
t_{小母牛}^{(k)} = \sum\limits_{i=1}^{2} x_{i} \times 10
$$
​	则饲养小母牛五年后所耗费时间为
$$
t_{小母牛} = \sum_{k=1}^{5} t_{小母牛}^{(k)} = \sum_{k=1}^{5} \sum_{i=1}^{2} x_{i}^{(k)} \times 10
$$
​	$t_{k}$ 年工人饲养小母牛所需资金 =  $t_{k}$ 年工人饲养小母牛的数量 $\times$ 饲养一只小母牛所需的资金
$$
c_{小母牛}^{(k)} = \sum_{i=1}^{2} x_{i}^{(k)} \times 500
$$
​	则饲养小母牛五年后所需资金为
$$
c_{小母牛} = \sum_{k=1}^{5} c_{小母牛}^{(k)} = \sum_{k=1}^{5} \sum_{i=1}^{2} x_{i}^{(k)} \times 500
$$

#### 老母牛

​	$t_{k}$ 年出售老母牛所得金额 =  $ t_{k}$ 年出售老母牛的数量  $\times$ 出售一只老母牛的价格

$$
w^{(k)}_{老母牛} =  x_{13}^{(k)} \times 120
$$

​	则出售老母牛五年后毛利为

$$
w_{老母牛} = \sum_{k=1}^{5} w^{(k)}_{老母牛} = \sum_{k=1}^{5} x_{13}^{(k)} \times 120
$$

#### 大母牛

​	$t_{k}$ 年出售牛奶所得金额 =  $ t_{k}$ 年可以产出牛奶的大母牛数量  $\times$ 出售一年牛奶的价格
$$
w^{(k)}_{大母牛} = \sum_{i=3}^{12} x_{i}^{(k)} \times 370
$$

​	则出售牛奶五年后毛利为
$$
w_{大母牛} = \sum_{k=1}^{5} w^{(k)}_{大母牛} = \sum_{k=1}^{5} \sum_{i=3}^{12} x_{i}^{(k)} \times 370
$$
​	$t_{k}$ 年工人饲养大母牛所耗费时间 =  $t_{k}$ 年工人饲养大母牛的数量 $\times$ 饲养一只大母牛所耗费的时间
$$
t_{大母牛}^{(k)} = \sum_{i=3}^{12} x_{i} \times 42
$$
​	则饲养大母牛五年后所耗费时间为
$$
t_{小母牛} = \sum_{k=1}^{5} t_{大母牛}^{(k)} = \sum_{k=1}^{5} \sum_{i=3}^{12} x_{i} \times 42
$$
​	$t_{k}$ 年工人饲养大母牛所需资金 =  $t_{k}$ 年工人饲养大母牛的数量 $\times$ 饲养一只大母牛所需的资金
$$
c_{大母牛}^{(k)} = \sum_{i=3}^{12} x_{i}^{(k)} \times 100\\
$$
​	则饲养大母牛五年后所需资金为
$$
c_{大母牛} = \sum_{k=1}^{5} c_{大母牛}^{(k)} = \sum_{k=1}^{5} \sum_{i=3}^{12} x_{i}^{(k)} \times 100
$$

#### 所有牛

$$
t^{(k)} = t_{小母牛}^{(k)} + t_{大母牛}^{(k)} + t_{\beta} + t_{\gamma} \\
if \quad t^{(k)} \leq 5500 \: , \: then \quad c_{工人}^{(k)} = 4000 \\
\quad \quad \quad \quad \quad \quad \quad \quad if \quad t^{(k)} \geq 5500 \: , \: then \quad c_{工人}^{(k)} = 4000 + (t^{(k)}-5500) \times 1.2\\
c_{\beta}^{(k)} = \beta \times 15\\
c_{\gamma}^{(k)} = \gamma \times 10
$$

### 贷款

​	设总贷款金额为$M$,贷款金额全部用于投资,此时,有,

$$
\sum_{i=1}^{12} x_{i}^{(\:k\:)} \leq \frac{M}{200}+130 \: , \: k = 0, \ldots, 5 \\
$$

​	至于还款,要求等额还款,市面上流行的还款方式为等额本金还款及等额本息还款,但仅有后者可保证每年还款数额固定不变,故确定还款方式为等额本息还款有,
$$
\text{每年应还额度} = \frac{贷款本金 \times 年利率 \times (1 + 年利率)^{还款年数}}{(1 + 年利率)^{还款年数} - 1}
$$

则,每年还款额度 $m$ 计算公式如下,

$$
m = \frac{M \times 0.15 \times (1 + 0.15)^{10}}{(1 + 0.15)^{10} - 1}
$$

### 土地

​	设牧草,甜菜,粮食种植所需土地分别为 $\alpha英亩,\beta英亩,\gamma英亩$
​	由题意知,每头小母牛需要$\frac{2}{3}$英亩的土地养活它,每头大母牛需要1英亩的土地养活它,然每头奶牛除了吃牧草以外,每年还需要0.6吨粮食和0.7吨甜菜. 即现有的200英亩土地分配$\beta英亩,\gamma英亩$分别种植甜菜和粮食外,剩余$\alpha$英亩土地均布满牧草。

#### 分牧草$\alpha$英亩

$$
\alpha \geq \frac{2}{3} \times \sum_{i=1}^{2} x_{i}^{(k)} + 1 \times \sum_{i=3}^{12} x_{i}^{(k)} \\
$$

#### 分粮食$\beta$英亩

$$
\beta = \beta_{1} + \beta_{2} + \beta_{3} + \beta_{4}\\
q_{\beta} = 1.1 \times \beta_{1} + 0.9 \times \beta_{2} + 0.8 \times \beta_{3} + 0.6 \times \beta_{4}\\

l_{\beta}^{(k)} = q_{\beta} - 0.6 \times \sum_{i=2}^{12} x_{i}^{(\:k\:)} \\
if \quad l_{\beta}^{(k)} \gt 0 \: , \: then \quad w_{\beta} = l_{\beta}^{(k)} \times 75 \\
if \quad l_{\beta}^{(k)} \lt 0 \: , \: then \quad w_{\beta} = l_{\beta}^{(k)} \times 90 \\
t_{\beta} = \alpha \times 4 \\
\beta_{1} \leq 20 \: , \\
\beta_{2} \leq 30 \: , \\
\beta_{3} \leq 30 \: , \\
\beta_{4} \leq 10 \: . \\
$$

#### 分甜菜$\gamma$英亩

$$
q_{\gamma}  = 1.5 \times \gamma\\
l_{\gamma}^{(k)} = q_{\gamma} - 0.7 \times \sum_{i=3}^{12} x_{i}^{(\:k\:)} \\
if \quad l_{\gamma}^{(k)} > 0\: , \: then \quad w_{\gamma}^{(k)} = l_{\gamma}^{(k)} \times 58 \\ 
if \quad l_{\gamma}^{(k)} < 0\: , \: then \quad w_{\gamma}^{(k)} = l_{\gamma}^{(k)} \times 70 \\
t_{\gamma} = \beta \times 14 \\
$$

#### 总土地大小限制

$$
\alpha + \beta + \gamma \leq 200
$$

## 模型建立与求解

$$
Max \: E = Max \: \sum_{k=1}^{5} E^{(k)} = Max \: \sum_{k=1}^{5} [w^{(k)} - c^{(k)}]
$$

​	其中
$$
w^{(k)} = w^{(k)}_{小公牛} + w^{(k)}_{小母牛} + w^{(k)}_{大母牛} + w^{(k)}_{老母牛} + w_{\beta}^{(k)} + w_{\gamma}^{(k)} \\
c^{(k)} = c_{\beta} + c_{\gamma} + c_{小母牛}^{(k)} + c_{大母牛}^{(k)} + c_{工人}^{(k)} + m \\
E^{(k)} = w^{(k)} - c^{(k)}\\
$$

### $种群数量（n）- 出售比例(r)$图

| 年份 | 种群总数                                       |
| :--: | :--------------------------------------------- |
|  0   | 120                                            |
|  1   | 162.2 - 55.0r                                  |
|  2   | 201.152 - 105.985r                             |
|  3   | 236.87934 - 153.0276r                          |
|  4   | 27.300625r² - 247.585052r + 293.2354506        |
|  5   | 79.362916875r² - 385.097726255r + 368.18760454 |

![](E:\LGRepository\China-Undergraduate-Mathematical-Contest-in-Modeling\第一次模拟训练A题\Python处理代码\Ideations\5 年内总牛群数量随r的变化.png)

![](E:\LGRepository\China-Undergraduate-Mathematical-Contest-in-Modeling\第一次模拟训练A题\Python处理代码\Ideations\r递增的羊群数量变化-直方图.png)